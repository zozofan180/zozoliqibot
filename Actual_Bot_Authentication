import http.client
import urllib
from urllib import parse
import json
import hashlib
from hashlib import sha512
import hmac
import time

api_key = 'PDZ3Z8VD-M1U56TTX-VS419MAY-8LABWXEU-FPCCMT3J'
api_secret = '9401c226530ff6d220e81aabf65b597acc12fdcbde18c650fecaa3067fc5ea22'


def get_info():
    nonce = int(round(time.time() - 139862111)*10)
    parms = {"method":"GetInfo",
              "nonce": nonce}

    parms = urllib.parse.urlencode(parms)
    secret_bytes = bytes(api_secret, 'latin-1')
    hashed = hmac.new(secret_bytes, digestmod=hashlib.sha512)
    signature = hashed.hexdigest()

    headers = {"Content-type":"application/x-www-form-urlencoded",
               "Key":api_key,
               "Signature": signature}
    conn = http.client.HTTPConnection("api.liqui.io")
    print("1")
    conn.request("POST", "/tapi", parms, headers)
    print("1")
    response = conn.getresponse()
    print("1")
    print(response.status,response.reason)
    conn.close()
